<?xml version="1.0"?>
<Container version="2">
  <Name>lancache-pihole-sidecar</Name>
  <Repository>ghcr.io/oct8l/lancache-pihole-sidecar:latest</Repository>
  <Registry>https://ghcr.io</Registry>
  <Network>bridge</Network>
  <MyIP/>
  <Shell>bash</Shell>
  <Privileged>false</Privileged>
  <Support>https://github.com/oct8l/lancache-pihole-sidecar/issues</Support>
  <Project>https://github.com/oct8l/lancache-pihole-sidecar</Project>
  <Overview>
Automatically keeps Pi-hole LANCache DNS records in sync using the uklans/cache-domains lists.[br]
[br]
This container only manages one file: /etc/dnsmasq.d/99-lancache-sidecar.conf[br]
Rollback is safe: set MODE=rollback (or ENABLE=false) to remove only sidecar-managed records.[br]
[br]
For Pi-hole v6, make sure FTLCONF_misc_etc_dnsmasq_d=true is set on the Pi-hole container.
  </Overview>
  <Category>Network:DNS Network:Tools</Category>
  <WebUI/>
  <TemplateURL>https://raw.githubusercontent.com/oct8l/lancache-pihole-sidecar/main/unraid/templates/lancache-pihole-sidecar.xml</TemplateURL>
  <Icon>https://raw.githubusercontent.com/oct8l/lancache-pihole-sidecar/main/unraid/templates/lancache-pihole-sidecar.svg</Icon>
  <ExtraParams/>
  <PostArgs/>
  <CPUset/>
  <DateInstalled>1700000000</DateInstalled>
  <Requires>Pi-hole must use the same host path for /etc/dnsmasq.d.</Requires>

  <Config Name="Pi-hole dnsmasq Path" Target="/etc/dnsmasq.d" Default="/mnt/user/appdata/pihole/dnsmasq.d" Mode="rw" Description="Host path shared with your Pi-hole /etc/dnsmasq.d mount." Type="Path" Display="always" Required="true" Mask="false">/mnt/user/appdata/pihole/dnsmasq.d</Config>
  <Config Name="Sidecar Data Path" Target="/var/lib/lancache-sidecar" Default="/mnt/user/appdata/lancache-pihole-sidecar" Mode="rw" Description="Persistent working data (cache-domains clone)." Type="Path" Display="always" Required="true" Mask="false">/mnt/user/appdata/lancache-pihole-sidecar</Config>

  <Config Name="LANCache IP(s)" Target="LANCACHE_IP" Default="" Mode="" Description="Required. One or more LANCache server IPs (comma-separated)." Type="Variable" Display="always" Required="true" Mask="false"></Config>
  <Config Name="Mode" Target="MODE" Default="run" Mode="" Description="run=normal loop, rollback=remove managed file and exit." Type="Variable" Display="advanced" Required="true" Mask="false">run</Config>
  <Config Name="Enable Sync" Target="ENABLE" Default="true" Mode="" Description="false removes sidecar-managed records (if REMOVE_ON_DISABLE=true)." Type="Variable" Display="advanced" Required="true" Mask="false">true</Config>
  <Config Name="Update Interval (Seconds)" Target="UPDATE_INTERVAL_SECONDS" Default="21600" Mode="" Description="How often to sync cache-domains and reconcile Pi-hole file." Type="Variable" Display="advanced" Required="true" Mask="false">21600</Config>
  <Config Name="Domain Groups" Target="DOMAIN_GROUPS" Default="all" Mode="" Description="Comma-separated group names from cache_domains.json, or 'all'." Type="Variable" Display="advanced" Required="true" Mask="false">all</Config>
  <Config Name="One Shot" Target="ONESHOT" Default="false" Mode="" Description="true runs once and exits." Type="Variable" Display="advanced" Required="true" Mask="false">false</Config>
  <Config Name="Reload Command" Target="RELOAD_COMMAND" Default="" Mode="" Description="Optional command run when records change or are removed. Example: docker exec pihole pihole restartdns reload-lists" Type="Variable" Display="advanced" Required="false" Mask="false"></Config>
  <Config Name="Output File" Target="OUTPUT_FILE" Default="/etc/dnsmasq.d/99-lancache-sidecar.conf" Mode="" Description="Managed dnsmasq file path inside container." Type="Variable" Display="advanced-hide" Required="true" Mask="false">/etc/dnsmasq.d/99-lancache-sidecar.conf</Config>
  <Config Name="Remove On Disable" Target="REMOVE_ON_DISABLE" Default="true" Mode="" Description="When ENABLE=false, remove managed file." Type="Variable" Display="advanced-hide" Required="true" Mask="false">true</Config>
  <Config Name="Strict Groups" Target="STRICT_GROUPS" Default="true" Mode="" Description="Fail when DOMAIN_GROUPS includes unknown entries." Type="Variable" Display="advanced-hide" Required="true" Mask="false">true</Config>
  <Config Name="Include local=/domain/" Target="INCLUDE_LOCAL_DIRECTIVE" Default="true" Mode="" Description="Emit local=/domain/ directives with address= lines." Type="Variable" Display="advanced-hide" Required="true" Mask="false">true</Config>
  <Config Name="Cache Domains Repo" Target="CACHE_DOMAINS_REPO" Default="https://github.com/uklans/cache-domains.git" Mode="" Description="Upstream cache-domains git repository." Type="Variable" Display="advanced-hide" Required="true" Mask="false">https://github.com/uklans/cache-domains.git</Config>
  <Config Name="Cache Domains Branch" Target="CACHE_DOMAINS_BRANCH" Default="master" Mode="" Description="Branch to sync from cache-domains repo." Type="Variable" Display="advanced-hide" Required="true" Mask="false">master</Config>
</Container>
